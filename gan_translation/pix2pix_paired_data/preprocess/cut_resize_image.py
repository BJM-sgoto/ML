import cv2
import os
import numpy as np

source_folder = './base/'
target_train_folder = './train/'
target_test_folder = './test/'

min_size = 384

files = [
	'cmp_b0091', 
	'cmp_b0092', 
	'cmp_b0093', 
	'cmp_b0097', 
	'cmp_b0098',
	'cmp_b0101',
	'cmp_b0102',
	'cmp_b0104',
	'cmp_b0147',
	'cmp_b0148',
	'cmp_b0149',
	'cmp_b0150',
	'cmp_b0151',
	'cmp_b0152',
	'cmp_b0153',
	'cmp_b0154',
	'cmp_b0155',
	'cmp_b0156',
	'cmp_b0157',
	'cmp_b0158',
	'cmp_b0159',
	'cmp_b0160',
	'cmp_b0161',
	'cmp_b0164',
	'cmp_b0165',
	'cmp_b0167',
	'cmp_b0170',
	'cmp_b0169',
	'cmp_b0171',
	'cmp_b0172',
	'cmp_b0173',
	'cmp_b0174',
	'cmp_b0175',
	'cmp_b0176',
	'cmp_b0177',
	'cmp_b0178',
	'cmp_b0179',
	'cmp_b0180',
	'cmp_b0181',
	'cmp_b0211',
	'cmp_b0212',
	'cmp_b0213',
	'cmp_b0214',
	'cmp_b0215',
	'cmp_b0216',
	'cmp_b0217',
	'cmp_b0218',
	'cmp_b0219',
	'cmp_b0220',
	'cmp_b0221',
	'cmp_b0222',
	'cmp_b0223',
	'cmp_b0224',
	'cmp_b0225',
	'cmp_b0226',
	'cmp_b0227',
	'cmp_b0228',
	'cmp_b0229',
	'cmp_b0230',
	'cmp_b0231',
	'cmp_b0232',
	'cmp_b0233',
	'cmp_b0234',
	'cmp_b0235',

	'cmp_x0220',
	'cmp_x0219',
	'cmp_x0216',
	'cmp_x0215',
	'cmp_x0214',
	'cmp_x0212',
	'cmp_x0205',
	'cmp_x0203',
	'cmp_x0199',
	'cmp_x0194',
	'cmp_x0192',
	'cmp_x0191',
	'cmp_x0189',
	'cmp_x0161',
	'cmp_x0159',
	'cmp_x0139',
	'cmp_x0140',
	'cmp_x0137',
	'cmp_x0136',
	'cmp_x0135',
	'cmp_x0134',
	'cmp_x0133',
	'cmp_x0132',
	'cmp_x0131',
	'cmp_x0130',
	'cmp_x0129',
	'cmp_x0128',
	'cmp_x0127',
	'cmp_x0126',
	'cmp_x0125',
	'cmp_x0124',
	'cmp_x0123',
	'cmp_x0122',
	'cmp_x0121',
	'cmp_x0120',
	'cmp_x0119',
	'cmp_x0118',
	'cmp_x0117',
	'cmp_x0116',
	'cmp_x0115',
	'cmp_x0114',
	'cmp_x0113',
	'cmp_x0112',
	'cmp_x0111',
	'cmp_x0110',
	'cmp_x0109',
	'cmp_x0108',
	'cmp_x0107',
	'cmp_x0106',
	'cmp_x0105',
	'cmp_x0104',
	'cmp_x0103',
	'cmp_x0092',
	'cmp_x0091',
	'cmp_x0090',
	'cmp_x0089',
	'cmp_x0088',
	'cmp_x0087',
	'cmp_x0086',
	'cmp_x0085',
	'cmp_x0084',
	'cmp_x0083',
	'cmp_x0082',
	'cmp_x0081',
	'cmp_x0080',
	'cmp_x0079',
	'cmp_x0078',
	'cmp_x0077',
	'cmp_x0076',
	'cmp_x0075',
	'cmp_x0074',
	'cmp_x0073',
	'cmp_x0072',
	'cmp_x0071',
	'cmp_x0070']

start_points = [
	[129,141],
	[135,76], 
	[182, 59], 
	[44, 90], 
	[66, 95], 
	[80, 174],
	[230,76],
	[50, 40],
	[200,100],
	[130,300],
	[120,225],
	[150,250],
	[150,250],
	[85,420],
	[120,400],
	[120,240],
	[100,400],
	[130,100],
	[150,130],
	[150,200],
	[150,150],
	[50,420],
	[160, 0],
	[40,70],
	[0,200],
	[256,350],
	[250,250],
	[25,200],
	[160,200],
	[250,150],
	[70,300],
	[80,150],
	[150,250],
	[320,300],
	[330,240],
	[400,200],
	[90,240],
	[100,200],
	[200,200],
	[120,350],
	[80,350],
	[100,300],
	[150,350],
	[150,350],
	[150,350],
	[150,350],
	[150,350],
	[150,350],
	[150,350],
	[150,350],
	[150,350],
	[150,350],
	[150,350],
	[65,300],
	[120,140],
	[120,140],
	[180,430],
	[180,430],
	[180,430],
	[180,430],
	[180,430],
	[180,430],
	[180,430],
	[180,430],

	[430, 30],
	[10,110],
	[50,80],
	[0,140],
	[0,80],
	[25,125],
	[0,40],
	[40,50],
	[50,80],
	[240,0],
	[0,0],
	[30,25],
	[250,50],
	[0,60],
	[0,200],
	[40,325],
	[0,150],
	[100,350],
	[130,350],
	[120,150],
	[80,300],
	[150,70],
	[125,475],
	[100,90],
	[100,400],
	[140,140],
	[75,250],
	[75,250],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[130,220],
	[90,360],
	[90,360],
	[90,360],
	[90,360],
	[90,360],
	[90,360],
	[90,360],
	[90,360],
	[30,300],
	[50,120],
	[100,200],
	[290,250],
	[50,120],
	[80,300],
	[290,400],
	[320,370],
	[150,180],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320],
	[100,320]]

end_points = [
	[929,1024], 
	[844,1024], 
	[1024,723], 
	[1024, 883], 
	[737, 1024], 
	[766, 990],
	[890,768],
	[870,620],
	[900,650],
	[600,1000],
	[600,1020],
	[650,1000],
	[600,1000],
	[650,1020],
	[620,1020],
	[560,1000],
	[580,1000],
	[660,1000],
	[670,840],
	[615,960],
	[660,1000],
	[570,1000],
	[640,1000],
	[800,800],
	[750,970],
	[750,960],
	[790,1000],
	[790,1000],
	[900,795],
	[880,1000],
	[600,1000],
	[830,760],
	[990,750],
	[950,820],
	[940,820],
	[980,710],
	[720,800],
	[780,780],
	[700,970], 
	[700,1000],
	[600,1024],
	[670,1020],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,1000],
	[600,760],
	[670,950],
	[670,950],
	[540,990],
	[540,990],
	[540,990],
	[540,990],
	[540,990],
	[540,990],
	[540,990],
	[540,990],

	[970,600],
	[720,560],
	[610,440],
	[830,410],
	[620,300],
	[790,400],
	[480,390],
	[550,460],
	[590,470],
	[880,580],
	[660,480],
	[610,510],
	[1024,584],
	[550,460],
	[460,430],
	[980,1024],
	[750,1024],
	[640,1024],
	[590,1024],
	[630,1024],
	[600,1000],
	[660,1000],
	[680,1000],
	[620,1000],
	[630,1024],
	[670,1000],
	[650,1000],
	[720,1024],
	[720,1024],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[650,1000],
	[730,1010],
	[730,1010],
	[730,1010],
	[730,1010],
	[730,1010],
	[630,1010],
	[630,1010],
	[630,1010],
	[860,750],
	[630,1010],
	[700,750],
	[920,830],
	[630,1010],
	[560,1000],
	[730,990],
	[925,925],
	[560,1000],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],
	[570,980],]

files2 = [x[:-4] for x in os.listdir(source_folder) if x.endswith('png') and not x[:-4] in files]
print(files2)


for i in range(len(files)):
	print("files " , files[i])
	
	target_folder = target_train_folder
	if np.random.rand()>0.9:
		target_folder = target_test_folder
		
	start_point = start_points[i]
	end_point = end_points[i]
	img1 = cv2.imread(source_folder + files[i] + '.jpg', cv2.IMREAD_UNCHANGED)
	h, w , _ = img1.shape
	
	img1 = img1[start_point[1]: end_point[1], start_point[0]: end_point[0]]
	h, w , _ = img1.shape
	rate = min_size / float(min([h, w]))
	nh = int(h*rate)
	nw = int(w*rate)
	img1 = cv2.resize(img1, (nw, nh))
	cv2.imwrite(target_folder + files[i] + '.jpg', img1)
	
	img2 = cv2.imread(source_folder + files[i] + '.png', cv2.IMREAD_UNCHANGED)
	img2 = img2[start_point[1]: end_point[1], start_point[0]: end_point[0]]
	img2 = cv2.resize(img2, (nw, nh))
	cv2.imwrite(target_folder + files[i] + '.png', img2)

for i in range(len(files2)):
	print("files 2 " , files2[i])
	
	target_folder = target_train_folder
	if np.random.rand()>0.9:
		target_folder = target_test_folder
	
	img1 = cv2.imread(source_folder + files2[i] + '.jpg', cv2.IMREAD_UNCHANGED)
	h, w , _ = img1.shape
	rate = min_size / min([h, w])
	nh = int(h*rate)
	nw = int(w*rate)
	img1 = cv2.resize(img1, (nw, nh))
	cv2.imwrite(target_folder + files2[i] + '.jpg', img1)
	
	img2 = cv2.imread(source_folder + files2[i] + '.png', cv2.IMREAD_UNCHANGED)
	img2 = cv2.resize(img2, (nw, nh))
	cv2.imwrite(target_folder + files2[i] + '.png', img2)